

          Configuration  con = new Configuration().configure().addAnnotatedClass(Student.class).addAnnotatedClass(Laptop.class);
          ServiceRegistry reg = new StandardServiceRegistryBuilder().applySettings(con.getProperties()).build();  // just to get rid of the  line under buildSessionFactory that is why it is a service


          SessionFactory sf = con.buildSessionFactory(); // for fetching
          SessionFactory sf = con.buildSessionFactory(reg); //  or this one  but you have to type the ServiceRegistry
          Session session = sf.openSession();


////!         fetching the data from the database

          myCar=(Car)session.get(Car.class, 50);
          System.out.println(myCar);



////!         fetching the data from the database [ EAGER and LAZY ] you have to mention it in the class
          session.beginTransaction();
          Student student= session.get(Student.class, 1);
          System.out.println(student.getAge());
          System.out.println(student.getLaptop());

          session.beginTransaction().commit();



//         Caching Level 1


    // the query will be called once in this but the output will be print twice
    //        Session session1 = sf.openSession();
    //
    //
    //        student=(Student) session1.get(Student.class, 1);
    //        System.out.println(student);
    //
    //        student=(Student) session1.get(Student.class, 1);
    //        System.out.println(student);
    //
    //
    //        session1.beginTransaction().commit();
    //        session1.close();



// before the query will be called twice and will be print twice
        Session session1 = sf.openSession();
        session1.beginTransaction();
        student=(Student) session1.get(Student.class, 1);
        System.out.println(student);
        session1.getTransaction().commit();
        session1.close();



        Session session2 = sf.openSession();
        session2.beginTransaction();
        student=(Student) session2.get(Student.class, 1);
        System.out.println(student);
        session2.getTransaction().commit();
        session2.close();// if you have more than one session you have to close them


//         Caching Level 2

// if you have tow different session but the same query , the query will be called once and the output will be twice
        Session session1 = sf.openSession();
        session1.beginTransaction();
        car=(Car) session1.get(Car.class, 1);
        System.out.println(car);
        session1.beginTransaction().commit();
        session1.close();



        Session session2 = sf.openSession();
        session2.beginTransaction();
        car=(Car) session2.get(Car.class, 1);
        System.out.println(car);
        session2.beginTransaction().commit();
        session2.close();// if you have more than one session you have to close them
// here if you want to use  Caching Level 2 , use it with one table because with multiple table like laptop and student it does not work


//         Caching Level  2 with query
        Session session1 = sf.openSession();
        session1.beginTransaction();
        Query q1 =session1.createQuery("FROM Car WHERE id=55");
        q1.setCacheable(true);
        car=(Car)q1.uniqueResult();
        System.out.println(car);
        session1.getTransaction().commit();
        session1.close();



        Session session2 = sf.openSession();
        session2.beginTransaction();
        Query q2 =session2.createQuery("FROM Car WHERE id=55");
        q2.setCacheable(true);
        car=(Car)q2.uniqueResult();
        System.out.println(car);
        session2.getTransaction().commit();
        session2.close();// if you have more than one session you have to close them
